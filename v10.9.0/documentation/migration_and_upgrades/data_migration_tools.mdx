# Data Migration Tools

## Introduction

This guide provides an overview of the tools and scripts available for migrating historical data within UTMStack version 10.9.0. UTMStack is a comprehensive cybersecurity platform designed for hybrid environments, offering integrated services such as SIEM, threat detection, compliance management, and more. This documentation focuses on data migration tools that facilitate the transition of data from other platforms and version upgrades.

## Snapshot Archiving

Snapshot archiving in UTMStack is a crucial feature for long-term data retention. It allows users to save snapshots to a specified path, which can be configured for remote storage. This feature ensures that even as indices are removed based on retention settings, a record of the data is retained.

### Configuring Snapshot Path in Linux

To redirect snapshots to another drive or remote location, follow these steps:

1. **Mount the Remote Drive or Different Drive**:
   ```bash
sudo mount -t nfs REMOTE-SERVER:/remote/path /utmstack/opensearch/backups
   ```
   Replace `REMOTE-SERVER:/remote/path` with your actual server and path details.

2. **Add to `/etc/fstab` for Persistence**:
   Add the mount details to `/etc/fstab` to ensure the remote drive remains mounted after system reboots.

3. **Test the Configuration**:
   ```bash
sudo mount -a
   ```

## Restoring Data Using Cerebro

Cerebro is an essential external tool for managing snapshots and restoring data in UTMStack. It enables efficient data transition from cold to hot storage by linking to your OpenSearch node.

### Installation & Access

- Use the [official Cerebro installation guide](https://github.com/lmenezes/cerebro).
- Once installed, access its interface, typically found at `http://localhost:9000`.

### Restoration Process

1. Link Cerebro with your OpenSearch node for seamless data restoration.
2. In the snapshot view, select a repository to restore the backup.

### Security Considerations

During the restoration process, it is necessary to open port 9200 to allow Cerebro to communicate with OpenSearch. Use the following commands to open and close the port securely:

- Open port 9200:
  ```bash
docker service update --publish-add 9200:9200 utmstack_node1
  ```

- Close port 9200 after restoration:
  ```bash
docker service update --publish-rm 9200:9200 utmstack_node1
  ```

Leaving the port open exposes your OpenSearch data to potential risks, so ensure it is closed after completing the restoration process.

## Summary

This guide has provided an overview of the tools and processes involved in migrating historical data within UTMStack. Snapshot archiving and the use of Cerebro for data restoration are key components of this process, ensuring data integrity and security during migration. For further details, refer to the official UTMStack documentation and the Cerebro installation guide.

For more information on data retention and configuration, visit the [UTMStack Data Retention Documentation](https://documentation.utmstack.com/v10/configuration/data_retention).
